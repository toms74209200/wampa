# Wampa 開発状況

## 現在の作業コンテキスト
- **作業中のファイル**: `pkg/config/cli.go`, `pkg/config/cli_test.go`
- **実装中の機能**: コマンドライン引数のパース処理
- **関連するテスト**: `pkg/config/cli_test.go`
- **現在の課題**: なし

## エラーとバグ追跡
- **コンパイルエラー**: なし
- **テストエラー**: なし
- **リントエラー**: なし

## 実装ステータス
### 完了した機能
- [x] プロジェクト仕様書の作成 (spec.md)
- [x] 技術要件の定義 (requirements.md)
  - [x] TOML対応の課題を明確化し、暫定対応としてJSONを使用
- [x] 受入テスト定義 (features/*.feature)
- [x] プロジェクト構造の設定
  - [x] ディレクトリ構造の作成
  - [x] 主要インターフェースの定義
  - [x] 依存関係の確認
- [x] 設定ファイル処理
  - [x] 設定ファイル読み込み（JSONベース）
  - [x] テーブル駆動テストの実装
  - [x] コマンドラインオプションと設定ファイルの責務分離
  - [ ] TOMLサポートへの移行（Go 2.0で導入予定のencoding/tomlパッケージ待ち）
- [x] ファイル監視モジュール
  - [x] ローカルファイル監視インターフェース定義
  - [x] fsnotifyを使用したローカルファイル監視実装
  - [x] ローカルファイル監視のテスト実装
  - [ ] リモートファイル監視（スコープ外として保留）
- [x] ファイル結合機能
  - [x] フォーマッターインターフェース設計
  - [x] Markdown対応フォーマット処理の実装
  - [x] フォーマッターのテスト実装
- [x] local_file_monitoring.featureの受け入れテスト実装
- [x] コマンドライン引数のパース処理
  - [x] `flag`パッケージを使用した引数パース処理の実装
  - [x] テスト駆動開発でユニットテストを実装
  - [x] 純粋関数としてテスト可能な設計を実現

### 進行中の機能
- [ ] config_file_handling.featureの実装
- [ ] メインパッケージの実装（cmd/wampa/main.goの作成）

### 保留中の機能
- [ ] TOMLサポートへの移行（標準ライブラリのencoding/tomlパッケージ対応待ち）
- [ ] リモートファイル監視（スコープ外）

## メモと参考情報
- TOMLサポートについて：
  - Go 2.0でencoding/tomlパッケージが導入予定
  - 暫定対応としてJSONを使用し、後でTOMLに移行
  - 移行時の影響を最小限にするため、設定ファイル処理を独立したパッケージとして実装
- テストカバレッジ
  - config パッケージ: テーブル駆動テストで主要パスをカバー
    - 設定ファイル処理とコマンドラインオプションの責務を分離
    - LoadFromFileはmedium testで検証予定
    - コマンドライン引数のパース処理は純粋関数としてテスト可能
  - watcher パッケージ: モックを使用したテストで複数のイベントケースをカバー
  - formatter パッケージ: テーブル駆動テストで実装完了
  - acceptance テスト: local_file_monitoring.featureの実装完了

## 直近の作業履歴
- コマンドライン引数のパース処理を純粋関数として実装
  - `flag.FlagSet`を外部から注入する設計に変更
  - テストケースを追加し、すべてのテストが成功